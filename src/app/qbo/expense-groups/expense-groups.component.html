<div class="page-header">
    <div class="page-header--name mat-h2">
        Expense Groups
    </div>
    <nav mat-tab-nav-bar>
        <a mat-tab-link (click)="changeState('READY')" [active]="state==='READY'">
            Ready
        </a>
        <a mat-tab-link (click)="changeState('COMPLETE')" [active]="state==='COMPLETE'">
            Complete
        </a>
        <a mat-tab-link (click)="changeState('ALL')" [active]="state==='ALL'">
            All
        </a>
    </nav>
</div>

<div fxLayoutAlign="center start" fxFlexFill *ngIf="isLoading">
    <app-loader></app-loader>
</div>

<div *ngIf="!isLoading" fxLayoutAlign="end center">
    <mat-form-field appearance="outline">
        <mat-label>Filter</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. ium">
    </mat-form-field>
</div>

<div [hidden]="isLoading">
    <table mat-table [dataSource]="expenseGroups" class="expense-groups" matSort matSortActive="created_at"
        matSortDisableClear matSortDirection="desc">
        <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef> Description </th>
            <td mat-cell *matCellDef="let element">
                Grouped by {{element.fyle_group_id}}
            </td>
        </ng-container>

        <ng-container matColumnDef="employee">
            <th mat-header-cell *matHeaderCellDef> Employee </th>
            <td mat-cell *matCellDef="let element"> {{element.description.employee_email}} </td>
        </ng-container>

        <ng-container matColumnDef="claimno">
            <th mat-header-cell *matHeaderCellDef> Claim No. </th>
            <td mat-cell *matCellDef="let element">
                {{element.description.claim_number}}
            </td>
        </ng-container>

        <ng-container matColumnDef="expensetype">
            <th mat-header-cell *matHeaderCellDef> Expense Type </th>
            <td mat-cell *matCellDef="let element">
                {{element.fund_source === 'PERSONAL' ? 'Reimbursable' : 'Corporate Credit Card'  }}
            </td>
        </ng-container>

        <ng-container matColumnDef="view">
            <th mat-header-cell *matHeaderCellDef> View </th>
            <td mat-cell *matCellDef="let element">
                <button class="btn" (click)="goToExpenseGroup(element.id)">
                    <i class="material-icons">open_in_new</i>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>
    </table>

    <mat-paginator [length]="count" [pageSizeOptions]="[5, 10, 20]" [pageSize]="pageSize" [pageIndex]="pageNumber"
        (page)="onPageChange($event)" showFirstLastButtons></mat-paginator>
</div>